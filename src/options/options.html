<!DOCTYPE html>
<html>

<head>
  <title>Mitaka</title>
  <link rel="stylesheet" href="css/bulma.css">
  <script src="../vendor.js"></script>
</head>

<body>
  <section class="section is-medium">
    <div class="container">
      <div class="columns is-centered">
        <div class="column is-half">
          <h1 class="title is-1">Mitaka</h1>

          <div  class="content">
            <ul>
              <li><a href="#general">General</a></li>
              <li><a href="#api-keys">API keys</a></li>
              <li><a href="#searchers">Searchers</a></li>
            </ul>
          </div>

          <div class="box" id="general">
            <h2 class="title is-2">General settings</h2>
            <div id="general-settings"></div>
            <hr>
            <article class="message is-warning">
              <div class="message-body">
                <strong>Warning</strong>: Enabling IDN extraction, strict TLD validation and refang option may cause a performance issue
              </div>
            </article>
          </div>

          <div class="box" id="api-keys">
            <h2 class="title is-2">API key settings</h2>
            <div class="field">
              <label class="label">
                <span class="icon">
                  <img src="https://t1.gstatic.com/faviconV2?client=SOCIAL&type=FAVICON&fallback_opts=TYPE,SIZE,URL&url=https://www.hybrid-analysis.com&size=16" />
                </span>
                <span>
                  <a href="https://www.hybrid-analysis.com">HybridAnalysis</a> API Key
                </span>
              </label>
              <div class="control">
                <input type="text" class="input" id="hybridanalysis-api-key">
              </div>
            </div>
            <div class="field">
              <label class="label">
                <span class="icon">
                  <img src="https://t1.gstatic.com/faviconV2?client=SOCIAL&type=FAVICON&fallback_opts=TYPE,SIZE,URL&url=https://urlscan.io&size=16" />
                </span>
                <span>
                  <a href="https://urlscan.io">urlscan.io</a> API Key
                </span>
              </label>
              <div class="control">
                <input type="text" class="input" id="urlscan-api-key">
              </div>
            </div>
            <div class="field">
              <label class="label">
                <span class="icon">
                  <img src="https://t1.gstatic.com/faviconV2?client=SOCIAL&type=FAVICON&fallback_opts=TYPE,SIZE,URL&url=https://www.virustotal.com&size=16" />
                </span>
                <span>
                  <a href="https://www.virustotal.com">VirusTotal</a> API Key
                </span>
              </label>
              <div class="control">
                <input type="text" class="input" id="virustotal-api-key">
              </div>
            </div>
          </div>

          <div class="box" id="searchers">
            <h2 class="title is-2">Searcher settings</h2>
            <div id="searcher-list"></div>
          </div>
        </div>
      </div>
    </div>
  </section>
  <script src="../options.js"></script>
  <script id="check-template" type="x-tmpl-mustache">
    <div class="field has-addons">
      <div class="control is-expanded">
        <div>
          <label class="label">
            <span class="icon">
              <img src="{{faviconURL}}" />
            </span>
            <span><a href="{{baseURL}}" target="_blank">{{name}}</a></span>
          </label>
          <span><strong>Supported types</strong>: {{joinedSupportedTypes}}</span>
        </div>
      </div>
      <div class="control">
        <input name="{{name}}" type="checkbox" {{#isEnabled}}checked="checked" {{/isEnabled}}>
        <label>Enable</label>
      </div>
    </div>
  </script>

  <script id="general-settings-template" type="x-tmpl-mustache">
    <div class="field has-addons">
      <div class="control is-expanded">
        <label class="label">
          Enable IDN extraction
        </label>
        <p>(IDN: Internationalized Domain Name)</p>
      </div>
      <div class="control">
        <input id="enable-idn" type="checkbox" {{#enableIDN}}checked="checked"{{/enableIDN}}>
        <label>Enable</label>
      </div>
    </div>

    <div class="field has-addons">
      <div class="control is-expanded">
        <label class="label">
          Enable strict TLD validation
        </label>
        <p>(TLD: Top Level Domain)</p>
      </div>
      <div class="control">
        <input id="strict-tld" type="checkbox" {{#strictTLD}}checked="checked"{{/strictTLD}}>
        <label>Enable</label>
      </div>
    </div>

    <div class="field has-addons mt-1">
      <div class="control is-expanded">
        <label class="label">
          Enable refang
        </label>
        <p>(Enable a transformation like <code>example[.]com</code> to <code>example.com</code>)</p>
      </div>
      <div class="control">
        <input id="enable-refang" type="checkbox" {{#enableRefang}}checked="checked"{{/enableRefang}}>
        <label>Enable</label>
      </div>
    </div>

    <div class="field has-addons mt-1">
      <div class="control is-expanded">
        <label class="label">
          Prefer href value
        </label>
        <p>(Prefer href value to text)</p>
      </div>
      <div class="control">
        <input id="prefer-href-value" type="checkbox" {{#preferHrefValue}}checked="checked"{{/preferHrefValue}}>
        <label>Enable</label>
      </div>
    </div>
  </script>
</body>
</html>
